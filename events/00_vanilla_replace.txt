namespace = ming_crisis
namespace = dai_disaster
namespace = flavor_bur
namespace = flavor_klm
namespace = flavor_lxa
namespace = majapahit
namespace = flavor_mal
namespace = pirates
namespace = flavor_teu
namespace = flavor_zim
namespace = flavor_zul
namespace = mch_missions

normal_or_historical_nations = yes

# Li Zicheng's rebellion and the Shun dynasty
country_event = {
	id = ming_crisis.3
	title = "ming_crisis.3.t"
	desc = "ming_crisis.3.d"
	picture = ANGRY_MOB_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	major = yes
	
	trigger = {
		NOT = { exists = CSH }
		num_of_owned_provinces_with = {
			value = 10
			region = north_china_region
			controlled_by = REB
		}
		any_owned_province = {
			OR = {
				area = gansu_area
				area = west_gansu_area
				area = shaanxi_area
				area = shanxi_area
				area = hebei_area
				area = south_hebei_area
				area = liaoning_area
			}
		}
		NOT = { has_global_flag = ming_crisis_3 } #so fire only once dosent break
	}
	
	immediate = {
		set_global_flag = ming_crisis_3
		hidden_effect = {
			every_owned_province = {
				limit = {
					OR = {
						controlled_by = REB
						controlled_by = ROOT
					}
					OR = {
						area = gansu_area
						area = west_gansu_area
						area = shaanxi_area
						area = shanxi_area
						area = hebei_area
						area = south_hebei_area
						area = liaoning_area
					}
					OR = {
						controlled_by = REB
						controlled_by = ROOT
					}
				}
				add_core = CSH
				clear_rebels = yes
			}
			every_owned_province = { #get rid of bordergore from random Mongolian provinces
				limit = {
					region = mongolia_region
					any_neighbor_province = {
						is_core = CSH
					}
					OR = {
						controlled_by = REB
						controlled_by = ROOT
					}
				}
				add_core = CSH
				clear_rebels = yes
			}
			release = CSH
			CSH = {
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.6
						cavalry = 0.3
						artillery = 0.1
					}
					remove_regular_units_from_prov = yes #dont use regular units
				}
				change_government = monarchy
				add_government_reform = chinese_warlord
				adopt_reform_progress = ROOT
			}
			if = {
				limit = {
					any_country = {
						NOT = { is_neighbor_of = ROOT }
						is_subject_of_type = tributary_state
						is_subject_of = ROOT
					}
				}
				every_country = {
					limit = {
						NOT = { is_neighbor_of = ROOT }
						is_subject_of_type = tributary_state
						is_subject_of = ROOT
					}
					country_event = {
						id = ming_crisis.10
					}
				}
			}
		}
	}
	
	option = {
		name = ming_crisis.3.a
		add_stability = -2
		add_mandate = -10
		CSH = {
			define_ruler = {
				name = "Zicheng"
				dynasty = "Li"
			}
			add_yearly_manpower = 15
			add_years_of_income = 15
		}
		if = {
			limit = {
				is_emperor_of_china = yes
			}
			CSH = {
				declare_war_with_cb = {
					who = root
					casus_belli = cb_take_mandate
				}
			}
		}
		else = {
			CSH = {
				declare_war = root
			}
		}
	}
	
	option = {
		name = ming_crisis.3.b
		trigger = {
			ai = no
		}
		add_stability = -2
		add_mandate = -10
		switch_tag = CSH
		CSH = {
			define_ruler = {
				name = "Zicheng"
				dynasty = "Li"
			}
			add_yearly_manpower = 15
			add_years_of_income = 15
		}
		if = {
			limit = {
				is_emperor_of_china = yes
			}
			CSH = {
				declare_war_with_cb = {
					who = root
					casus_belli = cb_take_mandate
				}
			}
		}
		else = {
			CSH = {
				declare_war = root
			}
		}
	}

	after = {
		hidden_effect = {
			CSH = {
				if = {
					limit = {
						any_neighbor_country = {
							has_reform = steppe_horde
							total_own_and_non_tributary_subject_development = 300
							is_subject = no
							#NOT = { truce_with = ROOT }
							NOT = { alliance_with = ROOT }
							#NOT = { is_subject_of = ROOT }
						}
					}
					random_neighbor_country = {
						limit = {
							has_reform = steppe_horde
							total_own_and_non_tributary_subject_development = 300
							is_subject = no
							#NOT = { truce_with = ROOT }
							NOT = { alliance_with = ROOT }
							#NOT = { is_subject_of = ROOT }
						}
						country_event = { id = ming_crisis.9 days = 1 }
					}
				}
				else_if = {
					limit = {
						any_neighbor_country = {
							tag = MCH
							is_free_or_tributary_trigger = yes
							NOT = { alliance_with = root }
						}
					}
					MCH = {
						country_event = { id = ming_crisis.9 days = 1 }
					}
				}
			}
		}
	}
}
# Yunnan Protectorate
country_event = {
	id = ming_crisis.4
	title = "ming_crisis.4.t"
	desc = "ming_crisis.4.d"
	picture = BAD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	major = yes
	
	trigger = {
		NOT = { exists = CDL }
		num_of_owned_provinces_with = {
			value = 10
			region = xinan_region
			controlled_by = REB
		}
		any_owned_province = {
			OR = {
				area = yun_gui_area
				area = chuannan_area
				area = yun_gui_borderland_area
			}
		}
		NOT = { has_global_flag = ming_crisis_4 } #so fire only once dosent break
	}
	
	immediate = {
		set_global_flag = ming_crisis_4
		hidden_effect = {
			every_owned_province = {
				limit = {
					OR = {
						controlled_by = REB
						controlled_by = ROOT
					}
					OR = {
						area = yun_gui_area
						area = chuannan_area
						area = yun_gui_borderland_area
					}
					OR = {
						controlled_by = REB
						controlled_by = ROOT
					}
					NOT = { is_core = CDL }
				}
				add_core = CDL
				clear_rebels = yes
			}
			release = CDL
			create_march = CDL
			CDL = {
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.6
						cavalry = 0.3
						artillery = 0.1
					}
					remove_regular_units_from_prov = yes #changes
				}
				change_government = monarchy
				add_government_reform = chinese_warlord
				adopt_reform_progress = ROOT
			}
			if = {
				limit = {
					any_country = {
						NOT = { is_neighbor_of = ROOT }
						is_subject_of_type = tributary_state
						is_subject_of = ROOT
					}
				}
				every_country = {
					limit = {
						NOT = { is_neighbor_of = ROOT }
						is_subject_of_type = tributary_state
						is_subject_of = ROOT
					}
					country_event = {
						id = ming_crisis.10
					}
				}
			}
		}
	}
	
	option = {
		name = ming_crisis.4.a
		ai_chance = { factor = 1 }
		add_mandate = -5
		CDL = { add_liberty_desire = 100 }
	}
	option = {
		name = ming_crisis.4.b
		ai_chance = { factor = 0 }
		add_mandate = 15
		CDL = {
			declare_war_with_cb = {
				who = root
				casus_belli = cb_independence_war
			}
		}
	}
	option = {
		name = ming_crisis.4.c
		trigger = { ai = no }
		add_mandate = 15
		switch_tag = CDL
		CDL = {
			declare_war_with_cb = {
				who = root
				casus_belli = cb_independence_war
			}
		}
	}
}
# Losing Control in the South
country_event = {
	id = ming_crisis.5
	title = "ming_crisis.5.t"
	desc = "ming_crisis.5.d"
	picture = BAD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	major = yes
	
	trigger = {
		OR = {
			NOT = { exists = WUU }
			NOT = { exists = YUE }
		}
		num_of_owned_provinces_with = {
			value = 10
			region = south_china_region
			controlled_by = REB
		}
		any_owned_province = {
			OR = {
				area = zhejiang_area
				area = fujian_area
				area = guangdong_area
				area = west_guangdong_area
				area = guangxi_area
			}
		}
		NOT = { has_global_flag = ming_crisis_5 } #So fire only once dosent break
	}
	
	immediate = {
		set_global_flag = ming_crisis_5
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						exists = WUU
					}
				}
				hidden_effect = {
					every_owned_province = {
						limit = {
							OR = {
								controlled_by = REB
								controlled_by = ROOT
							}
							OR = {
								area = zhejiang_area
								area = fujian_area
							}
							OR = {
								controlled_by = REB
								controlled_by = ROOT
							}
							NOT = { is_core = WUU }
						}
						add_core = WUU
						clear_rebels = yes
					}
					release = WUU
					create_march = WUU
					WUU = {
						capital_scope = {
							build_to_forcelimit = {
								infantry = 0.6
								cavalry = 0.3
								artillery = 0.1
							}
							remove_regular_units_from_prov = yes #changes
						}
						change_government = monarchy
						add_government_reform = chinese_warlord
						adopt_reform_progress = ROOT
					}
				}
			}
			if = {
				limit = {
					NOT = {
						exists = YUE
					}
				}
				hidden_effect = {
					every_owned_province = {
						limit = {
							OR = {
								controlled_by = REB
								controlled_by = ROOT
							}
							OR = {
								area = guangdong_area
								area = west_guangdong_area
								area = guangxi_area
							}
							OR = {
								controlled_by = REB
								controlled_by = ROOT
							}
							NOT = { is_core = YUE }
						}
						add_core = YUE
						clear_rebels = yes
					}
					release = YUE
					create_march = YUE
					YUE = {
						capital_scope = {
							build_to_forcelimit = {
								infantry = 0.6
								cavalry = 0.3
								artillery = 0.1
							}
							remove_regular_units_from_prov = yes #changes
						}
						change_government = monarchy
						add_government_reform = chinese_warlord
						adopt_reform_progress = ROOT
					}
				}
			}
			if = {
				limit = {
					any_country = {
						NOT = { is_neighbor_of = ROOT }
						is_subject_of_type = tributary_state
						is_subject_of = ROOT
					}
				}
				every_country = {
					limit = {
						NOT = { is_neighbor_of = ROOT }
						is_subject_of_type = tributary_state
						is_subject_of = ROOT
					}
					country_event = {
						id = ming_crisis.10
					}
				}
			}
		}		
	}
	
	option = {
		name = ming_crisis.5.a
		ai_chance = { factor = 1 }
		add_mandate = -5
		if = {
			limit = {
				exists = YUE
				overlord_of = YUE
			}
			YUE = { add_liberty_desire = 100 }
		}
		if = {
			limit = {
				exists = WUU
				overlord_of = WUU
			}
			WUU = { add_liberty_desire = 100 }
		}
	}
	option = {
		name = ming_crisis.5.b
		ai_chance = { factor = 0 }
		add_mandate = 15
		if = {
			limit = {
				exists = YUE
				YUE = {
					is_subject_of = ROOT
				}
			}
			YUE = {
				declare_war_with_cb = {
					who = root
					casus_belli = cb_independence_war
				}
			}
		}
		if = {
			limit = {
				exists = WUU
				WUU = {
					is_subject_of = ROOT
				}
			}
			WUU = {
				declare_war_with_cb = {
					who = root
					casus_belli = cb_independence_war
				}
			}
		}
	}
	option = {
		name = ming_crisis.5.c
		trigger = { ai = no }
		ai_chance = { factor = 0 }
		add_mandate = 15
		switch_tag = YUE
		if = {
			limit = {
				exists = YUE
				YUE = {
					is_subject_of = ROOT
				}
			}
			YUE = {
				declare_war_with_cb = {
					who = root
					casus_belli = cb_independence_war
				}
			}
		}
		if = {
			limit = {
				exists = WUU
				WUU = {
					is_subject_of = ROOT
				}
			}
			WUU = {
				declare_war_with_cb = {
					who = root
					casus_belli = cb_independence_war
				}
			}
		}
	}
	option = {
		name = ming_crisis.5.e
		trigger = { ai = no }
		ai_chance = { factor = 0 }
		add_mandate = 15
		switch_tag = WUU
		if = {
			limit = {
				exists = YUE
				YUE = {
					is_subject_of = ROOT
				}
			}
			YUE = {
				declare_war_with_cb = {
					who = root
					casus_belli = cb_independence_war
				}
			}
		}
		if = {
			limit = {
				exists = WUU
				WUU = {
					is_subject_of = ROOT
				}
			}
			WUU = {
				declare_war_with_cb = {
					who = root
					casus_belli = cb_independence_war
				}
			}
		}
	}
}

# Dai Viet splits in two
country_event = {
	id = dai_disaster.2
	title = dai_disaster.2.t
	desc = dai_disaster.2.d
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes
	major = yes
	fire_only_once = yes
	trigger = {
		NOT = { has_global_flag = dai_disaster_2 } #so fire only once dosent break
	}

	immediate = {
		set_global_flag = dai_disaster_2
		hidden_effect = {
			# Create Northern country if Dai Viet picked the Southern Dynasty
			if = {
				limit = {
					has_country_flag = dai_southern_dynasty
				}
				every_owned_province = {
					limit = {
						is_core = ROOT
						OR = {
							area = north_laos_area
							area = central_thai_area
							area = northern_thai_area
							area = red_river_delta_area
							area = sukhothai_area
							area = champasak_area
							area = khorat_area
							area = vientiane_area
							superregion = china_superregion
							region = burma_region
						}
					}
					add_core = TOK
				}
				release = TOK
				TOK = {
					change_government = monarchy
					add_government_reform = confucian_bureaucracy
					if = {
						limit = {
							current_age = age_of_reformation
						}
						define_ruler = {
							dynasty = "Mac"
						}
					}
					else = {
						define_ruler = {
							dynasty = "Trinh"
						}
					}
				}
				every_subject_country = {
					limit = {
						capital_scope = {
							OR = {
								area = north_laos_area
								area = central_thai_area
								area = northern_thai_area
								area = red_river_delta_area
								area = sukhothai_area
								area = champasak_area
								area = vientiane_area
								superregion = china_superregion
								region = burma_region
							}
						}
					}
					TOK = {
						vassalize = PREV
					}
				}
				every_owned_province = {
					add_core = TOK
				}
				TOK = {
					save_event_target_as = vietnam_rival_dynasty
				}
			}
			# Create Southern country if Dai Viet picked the Northern Dynasty
			else = {
				every_owned_province = {
					limit = {
						is_core = ROOT
						OR = {
							area = vietnam_area
							area = cambodia_area
							area = mekong_area
							area = angkor_area
							area = champa_area
							area = tay_nguyen_area
							region = malaya_region
							region = indonesia_region
						}
					}
					add_core = ANN
				}
				release = ANN
				ANN = {
					change_government = monarchy
					add_government_reform = confucian_bureaucracy
					if = {
						limit = {
							current_age = age_of_reformation
						}
						define_ruler = {
							dynasty = "Le"
						}
					}
					else = {
						define_ruler = {
							dynasty = "Nguyen" 
						}
					}
				}
				every_subject_country = {
					limit = {
						capital_scope = {
							OR = {
								area = vietnam_area
								area = cambodia_area
								area = mekong_area
								area = angkor_area
								area = champa_area
								area = tay_nguyen_area
								region = malaya_region
								region = indonesia_region
							}
						}
					}
					ANN = {
						vassalize = PREV
					}
				}
				every_owned_province = {
					add_core = ANN
				}
				ANN = {
					save_event_target_as = vietnam_rival_dynasty
				}
			}
		}
	}
	
	option = { # for the southern dynasty
		name = dai_disaster.2.a
		trigger = {
			has_country_flag = dai_southern_dynasty
		}
		change_tag = ANN
		end_disaster = northern_and_southern_dynasties
		hidden_effect = {
			TOK = {
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.6
						cavalry = 0.3
						artillery = 0.1
					}
					remove_regular_units_from_prov = yes #changes
				}
			}
			if = {
				limit = {
					TOK = {
						any_owned_province = {
							has_port = yes
						}
					}
				}
				TOK = {
					random_owned_province = {
						limit = {
							has_port = yes
						}
						build_to_forcelimit = {
							galley = 0.6
							transport = 0.3
							light_ship = 0.1
						}
					}
				}
			}
		}
	}
	option = { # for the northern dynasty
		name = dai_disaster.2.a
		trigger = {
			has_country_flag = dai_northern_dynasty
		}
		change_tag = TOK
		end_disaster = northern_and_southern_dynasties
		hidden_effect = {
			ANN = {
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.6
						cavalry = 0.3
						artillery = 0.1
					}
					remove_regular_units_from_prov = yes #changes
				}
			}
			if = {
				limit = {
					ANN = {
						any_owned_province = {
							has_port = yes
						}
					}
				}
				ANN = {
					random_owned_province = {
						limit = {
							has_port = yes
						}
						build_to_forcelimit = {
							galley = 0.6
							transport = 0.3
							light_ship = 0.1
						}
					}
				}
			}
		}
	}
}
# Dutch Mobilization
country_event = {
	id = flavor_bur.11
	title = "flavor_bur.EVTNAME11"
	desc = "flavor_bur.EVTDESC11"
	picture = MILITARY_CAMP_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "EXCELLENT"
		NED = {
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.6
					cavalry = 0.3
					artillery = 0.1
				}
				remove_regular_units_from_prov = yes #changes
			}
			random_owned_province = {
				limit = {
					has_port = yes
				}
				build_to_forcelimit = {
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.2
				}
			}
			add_treasury = 500
			create_general = {
				tradition = 80
			}
		}
	}
}
country_event = {
	id = flavor_klm.1
	title = "flavor_klm.t.1"
	desc = "flavor_klm.d.1"
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		NOT = { has_global_flag = flavor_klm_1 } #so fire only once dosent break
		is_year = 1600
		any_country = {
			OR = {
				primary_culture = altaic_new 
				culture_group = altaic
			}
			total_development = 200
			owns_core_province = 4678
		}
		is_subject = no
		is_at_war = no
		NOT = { exists = KLM }
		owns_core_province = 2417
	}
	mean_time_to_happen = {
		months = 600
	}
	immediate = {
		set_global_flag = flavor_klm_1
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						capital_scope = {
							area = astrakhan_area
						}
					}
				}
				every_owned_province = {
					limit = {
						area = astrakhan_area
					}
					add_core = KLM
				}
				release = KLM
				KLM = {
					change_government = tribal
					add_government_reform = steppe_horde
					define_ruler = {
						dynasty = Torghut
					}
					adopt_reform_progress = ROOT
					capital_scope = {
						build_to_forcelimit = {
							infantry = 0.6
							cavalry = 0.3
						}
						remove_regular_units_from_prov = yes #changes
					}
				}
				2417 = {
					change_religion = vajrayana
					change_culture = oirats
				}
			}
		}
	}
	option = {
		name = "flavor_klm.1.a"
		trigger = {
			NOT = {
				capital_scope = {
					area = astrakhan_area
				}
			}
		}
		create_march = KLM
		KLM = {
			add_opinion = {
				who = ROOT
				modifier = allowed_kalmyk_settlement
			}
		}
		astrakhan_area = {
			limit = {
				is_core = ROOT
			}
			remove_core = ROOT
		}
	}
	option = {
		name = "flavor_klm.1.b"
		trigger = {
			NOT = {
				capital_scope = {
					area = astrakhan_area
				}
			}
		}
		declare_war_with_cb = {
			who = KLM
			casus_belli = cb_core
			war_goal_province = 2417
		}
	}
	option = {
		name = "flavor_klm.1.b"
		trigger = {
			capital_scope = {
				area = astrakhan_area
			}
		}
		2417 = {
			spawn_rebels = {
				type = anti_tax_rebels
				size = 2
			}
		}
	}
}
# Champassak
country_event = {
	id = flavor_lxa.1
	title = flavor_lxa.1.t
	desc = flavor_lxa.1.d
	picture = NUSANTARA_WAR_eventPicture
	
	is_triggered_only = yes
	major = yes
	
	trigger = {
		tag = LXA
		has_dlc = "Leviathan"
		NOT = { exists = CHK }
		4839 = {
			owned_by = ROOT
			controlled_by = REB
			has_rebel_faction = pretender_rebels
		}
		has_spawned_rebels = pretender_rebels
	}
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					OR = {
						owns_core_province = 614
						owns_core_province = 615
					}
				}
				set_country_flag = champassak_flag
				every_owned_province = {
					limit = {
						OR = {
							area = champasak_area
							area = khorat_area
						}
					}
					add_core = CHK
					clear_rebels = yes
				}
				release = CHK
				CHK = {
					change_government = monarchy
					add_government_reform = mandala_reform
					define_ruler = {
						dynasty = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = flavor_lxa.1.a
		add_stability = -1
		add_prestige = -25
		if = {
			limit = {
				has_country_flag = champassak_flag
			}
			hidden_effect = {
				CHK = {
					capital_scope = {
						build_to_forcelimit = {
							infantry = 0.6
							cavalry = 0.3
							artillery = 0.1
						}
						remove_regular_units_from_prov = yes #changes
					}
				}
			}
		}
		else = {
			change_tag = CHK
		}
	}
}
# Vientiane
country_event = {
	id = flavor_lxa.2
	title = flavor_lxa.2.t
	desc = flavor_lxa.2.d
	picture = NUSANTARA_WAR_eventPicture
	
	is_triggered_only = yes
	major = yes
	
	trigger = {
		tag = LXA
		has_dlc = "Leviathan"
		NOT = { exists = VIE }
		614 = {
			owned_by = ROOT
			controlled_by = REB
			has_rebel_faction = pretender_rebels
		}
		has_spawned_rebels = pretender_rebels
	}
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					OR = {
						owns_core_province = 4839
						owns_core_province = 615
					}
				}
				set_country_flag = vientiane_flag
				every_owned_province = {
					limit = {
						OR = {
							area = vientiane_area
							area = khorat_area
						}
					}
					add_core = VIE
					clear_rebels = yes
				}
				release = VIE
				VIE = {
					change_government = monarchy
					add_government_reform = mandala_reform
					define_ruler = {
						dynasty = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = flavor_lxa.1.a
		add_stability = -1
		add_prestige = -25
		if = {
			limit = {
				has_country_flag = vientiane_flag
			}
			hidden_effect = {
				VIE = {
					capital_scope = {
						build_to_forcelimit = {
							infantry = 0.6
							cavalry = 0.3
							artillery = 0.1
						}
						remove_regular_units_from_prov = yes #changes
					}
				}
			}
		}
		else = {
			change_tag = VIE
		}
	}
}
# Luang Prabang
country_event = {
	id = flavor_lxa.3
	title = flavor_lxa.3.t
	desc = flavor_lxa.3.d
	picture = NUSANTARA_WAR_eventPicture
	
	is_triggered_only = yes
	major = yes
	
	trigger = {
		tag = LXA
		has_dlc = "Leviathan"
		OR = {
			AND = {
				NOT = { exists = LUA }
				615 = {
					owned_by = ROOT
					controlled_by = REB
					has_rebel_faction = pretender_rebels
				}
				has_spawned_rebels = pretender_rebels
			}
			NOT = {
				owns_core_province = 4839
				owns_core_province = 614
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					OR = {
						owns_core_province = 4839
						owns_core_province = 614
					}
				}
				set_country_flag = luang_prabang_flag
				every_owned_province = {
					limit = {
						area = north_laos_area
					}
					add_core = LUA
					clear_rebels = yes
				}
				release = LUA
				LUA = {
					change_government = monarchy
					add_government_reform = mandala_reform
					define_ruler = {
						dynasty = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = flavor_lxa.1.a
		add_stability = -1
		add_prestige = -25
		if = {
			limit = {
				has_country_flag = luang_prabang_flag
			}
			hidden_effect = {
				LUA = {
					capital_scope = {
						build_to_forcelimit = {
							infantry = 0.6
							cavalry = 0.3
							artillery = 0.1
						}
						remove_regular_units_from_prov = yes #changes
					}
				}
			}
		}
		else = {
			change_tag = LUA
		}
	}
}
# The Rise of Demak
country_event = {
	id = majapahit.5
	title = majapahit.5.t
	desc = majapahit.5.d
	picture = CIVIL_WAR_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	major = yes
	
	trigger = {
		NOT = { has_global_flag = majapahit_5 } #so fire only once dosent break
		NOT = { has_country_flag = maj_no_more_bad_religion_events }
		NOT = { exists = DMK }
		NOT = { legitimacy = 75 }
		629 = {
			religion = sunni
			owned_by = ROOT
		}
		num_of_owned_provinces_with = {
			value = 4
			religion = sunni
			region = indonesia_region
		}
	}
	
	immediate = {
		set_global_flag = majapahit_5
		hidden_effect = {
			DMK = {
				set_saved_name = {
					key = demak_sultan
					type = leader
				}
			}
			629 = {
				add_core = DMK
			}
			if = {
				limit = {
					4792 = {
						owned_by = ROOT
					}
				}
				4792 = {
					add_core = DMK
				}
			}
			if = {
				limit = {
					4793 = {
						owned_by = ROOT
					}
				}
				4793 = {
					add_core = DMK
				}
			}
			if = {
				limit = {
					2689 = {
						owned_by = ROOT
					}
				}
				2689 = {
					add_core = DMK
				}
			}
			release = DMK
			DMK = {
				change_religion = sunni
				change_government = monarchy
				add_government_reform = mandala_reform
				define_ruler = {
					name = demak_sultan
					dynasty = ROOT
					claim = 95
				}
			}
			add_truce_with = DMK	
		}
	}
	
	option = {
		name = majapahit.5.a
		every_owned_province = {
			limit = {
				region = indonesia_region
			}
			add_claim = DMK
		}
		hidden_effect = {
			DMK = {
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.6
						cavalry = 0.3
						artillery = 0.1
					}
					remove_regular_units_from_prov = yes #changes
				}
				random_owned_province = {
					limit = {
						has_port = yes
					}
					build_to_forcelimit = {
						galley = 0.5
						light_ship = 0.2
						transport = 0.2
					}
				}
			}
		}
	}
}
# The Rise of Mataram
country_event = {
	id = majapahit.6
	title = majapahit.6.t
	desc = majapahit.6.d
	picture = CIVIL_WAR_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	major = yes
	
	trigger = {
		NOT = { has_global_flag = majapahit_6 } #so fire only once dosent break
		NOT = { legitimacy = 75 }
		NOT = { has_country_flag = maj_no_more_bad_religion_events }
		NOT = { exists = MTR }
		2690 = {
			religion = sunni
			owned_by = ROOT
		}
		num_of_owned_provinces_with = {
			value = 4
			religion = sunni
			region = indonesia_region
		}
	}
	
	immediate = {
		set_global_flag = majapahit_6
		hidden_effect = {
			2690 = {
				add_core = MTR
			}
			if = {
				limit = {
					626 = {
						owned_by = ROOT
					}
				}
				626 = {
					add_core = MTR
				}
			}
			if = {
				limit = {
					2691 = {
						owned_by = ROOT
					}
				}
				2691 = {
					add_core = MTR
				}
			}
			if = {
				limit = {
					4793 = {
						owned_by = ROOT
					}
				}
				4793 = {
					add_core = MTR
				}
			}
			release = MTR
			MTR = {
				change_religion = sunni
				change_government = monarchy
				add_government_reform = mandala_reform
			}
			add_truce_with = MTR	
		}
	}
	
	option = {
		name = majapahit.5.a
		every_owned_province = {
			limit = {
				region = indonesia_region
			}
			add_claim = MTR
		}
		hidden_effect = {
			MTR = {
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.6
						cavalry = 0.3
						artillery = 0.1
					}
					remove_regular_units_from_prov = yes #changes
				}
				random_owned_province = {
					limit = {
						has_port = yes
					}
					build_to_forcelimit = {
						galley = 0.5
						light_ship = 0.2
						transport = 0.2
					}
				}
			}
		}
	}
}
# Rise of Fulo
province_event = {
	id = flavor_mal.2
	title = flavor_mal.2.t
	desc = flavor_mal.2.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	fire_only_once = yes

	trigger = {
		NOT = { has_global_flag = flavor_mal_2 } #so fire only once dosent break
		province_id = 2238
		NOT = { exists = FUL }
		is_year = 1470
		tekrur_area = {
			is_empty = yes
		}
	}

	mean_time_to_happen = {
		months = 36
	}
	
	immediate = {
		set_global_flag = flavor_mal_2
		hidden_effect = {
			every_province = {
				limit = {
					OR = {
						area = tekrur_area
						province_id = 1112 #Trarza
						province_id = 1120 #Bambuk
						province_id = 2238 #Kantor
						province_id = 2243 #Termes
						province_id = 2245 #Wagadu
						province_id = 2246 #Bagena
					}
				}
				add_core = FUL
				if = {
					limit = {
						owner = {
							NOT = { has_country_flag = fulani_info_flag }
						}
					}
					owner = {
						country_event = { id = flavor_mal.3 }
						set_country_flag = fulani_info_flag
					}
				}
				every_province = {
					limit = {
						OR = {
							area = tekrur_area
							province_id = 1112 #Trarza
							province_id = 1120 #Bambuk
							province_id = 2238 #Kantor
							province_id = 2243 #Termes
							province_id = 2245 #Wagadu
							province_id = 2246 #Bagena
						}
						is_empty = no
					}
					add_province_modifier = {
						name = "mal_fulani_migration"
						duration = 3650
					}
					change_culture = fulani
				}
				baghena_area = {
					limit = {
						culture = fulani
					}
					if = {
						limit = {
							is_core = SOF
							NOT = { owned_by = SOF }
						}
						remove_core = SOF
					}
					add_core = ZAF
				}
			}
		}
	}
	
	option = {
		name = flavor_mal.2.a
		every_province = {
			limit = {
				OR = {
					area = tekrur_area
					province_id = 1112 #Trarza
					province_id = 1120 #Bambuk
					province_id = 2238 #Kantor
					province_id = 2243 #Termes
					province_id = 2245 #Wagadu
					province_id = 2246 #Bagena
				}
				is_empty = yes
			}
			cede_province = FUL
		}
		hidden_effect = {
			FUL = {
				define_ruler = {
					name = "Koli Tengella"
					dynasty = "Denianke"
					change_mil = 4
					claim = 100
				}
				if = {
					limit = {
						has_dlc = "Rights of Man" 
					}
					add_ruler_personality_ancestor = { key = conqueror }
				}
				adopt_reform_progress = ROOT
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.7
						cavalry = 0.3
					}
					remove_regular_units_from_prov = yes #changes
					add_base_tax = 3
					add_base_production = 3
					add_base_manpower = 2
				}
				add_manpower = 10
				add_treasury = 300
			}
		}
	}
	
	
	option = {	#Switch tag to Fulo
		name = flavor_mal.2.b
		trigger = {
			owner = {
				ai = no
			}
		}
		every_province = {
			limit = {
				OR = {
					area = tekrur_area
					province_id = 1112 #Trarza
					province_id = 1120 #Bambuk
					province_id = 2238 #Kantor
					province_id = 2243 #Termes
					province_id = 2245 #Wagadu
					province_id = 2246 #Bagena
				}
				is_empty = yes
			}
			cede_province = FUL
		}
		hidden_effect = {
			FUL = {
				define_ruler = {
					name = "Koli Tengella"
					dynasty = "Denianke"
					change_mil = 4
					claim = 100
				}
				if = {
					limit = {
						has_dlc = "Rights of Man" 
					}
					add_ruler_personality_ancestor = { key = conqueror }
				}
				adopt_reform_progress = ROOT
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.7
						cavalry = 0.3
					}
					remove_regular_units_from_prov = yes #changes
					add_base_tax = 3
					add_base_production = 3
					add_base_manpower = 2
				}
				add_manpower = 10
				add_treasury = 300
			}
		}
		owner = {
			switch_tag = FUL
		}
	}
}
# The Pirates of New Providence
country_event = {
	id = pirates.2
	title = "pirates.2.t"
	picture = CARIBBEAN_PIRATE_FORT_eventPicture
	desc = "pirates.2.d"

	fire_only_once = yes

	trigger = {
		NOT = { has_global_flag = pirates_2 } #so fire only once dosent break
		has_dlc = "Golden Century"
		NOT = { exists = NSS }
		has_global_flag = golden_age_of_piracy
		NOT = { has_reform = pirate_republic_reform }
		OR = {
			AND = {
				owns_core_province = 482
				is_subject = no
				num_of_cities = 2
			}
			any_subject_country = {
				owns_core_province = 482
				num_of_cities = 2
			}
		}
		OR = {
			482 = {
				recent_treasure_ship_passage = yes
			}
			482 = {
				privateer_power = { share = 5 }
			}
			any_country = {
				capital_scope = {
					region = carribeans_region
				}
				war_exhaustion = 5
			}
		}
	}

	immediate = {
		set_global_flag = pirates_2
		hidden_effect = {
			482 = {
				discover_country = NSS
				add_core = NSS
			}
		}
	}

	mean_time_to_happen = {
		months = 12
	}

	option = { # play as the pirates
		name = "pirates.2.a"
		# play as NSS
		trigger = {
			ai = no
		}
		482 = {
			owner = {
				release = NSS
			}
		}
		NSS = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = ROOT
			discover_provinces = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "Benjamin"
				dynasty = "Hornigold"
				adm = 3
				dip = 3
				mil = 5
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			set_ruler_flag = historical_pirate
			swap_non_generic_missions = yes
		}
		switch_tag = NSS
	}
	option = { # pirates get released
		name = "pirates.2.b"
		482 = {
			owner = {
				release = NSS
			}
		}
		NSS = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes
			}
			define_ruler = {
				name = "Benjamin"
				dynasty = "Hornigold"
				adm = 3
				dip = 3
				mil = 5
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			set_ruler_flag = historical_pirate
			swap_non_generic_missions = yes
		}
	}

	after = { # Trigger an event, which will swap the national ideas of pirate tag with correct ideas
		hidden_effect = {
			NSS = {
				country_event = {
					id = pirates.25
				}
			}
		}
	}
}
# Libertatia
country_event = {
	id = pirates.3
	title = "pirates.3.t"
	picture = BUCCANEERS_eventPicture
	desc = "pirates.3.d"

	fire_only_once = yes

	trigger = {
		NOT = { has_global_flag = pirates_3 } #so fire only once dosent break
		has_dlc = "Golden Century"
		not = { exists = LIB }
		capital_scope = {
			continent = africa
		}
		NOT = { has_reform = pirate_republic_reform }
		kongo_region = {
			owner = {
				capital_scope = {
					continent = europe
				}
			}
		}
		OR = {
			india_superregion = {
				owner = {
					capital_scope = {
						continent = europe
					}
				}
			}
			east_indies_superregion = {
				owner = {
					capital_scope = {
						continent = europe
					}
				}
			}
		}
		has_global_flag = golden_age_of_piracy
		owns_core_province = 4024
		num_of_cities = 2
		OR = {
			4024 = {
				recent_treasure_ship_passage = yes
			}
			4024 = {
				privateer_power = { share = 5 }
			}
		}
	}

	immediate = {
		set_global_flag = pirates_3
		hidden_effect = {
			4024 = {
				discover_country = LIB
				add_core = LIB
			}
		}
	}

	mean_time_to_happen = {
		months = 12
	}

	option = { # play as the pirates
		name = "pirates.3.a"
		trigger = {
			ai = no
		}
		release = LIB
		LIB = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = ROOT
			discover_provinces = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "James"
				dynasty = "Mission"
				adm = 4
				dip = 2
				mil = 3
			}
			define_advisor = {
				type = theologian
				skill = 3
				name = "Signor Caraccioli"
				cost_multiplier = 0.25
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
		switch_tag = LIB
	}
	option = { # pirates get released
		name = "pirates.3.b"
		release = LIB
		LIB = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "James"
				dynasty = "Mission"
				adm = 4
				dip = 2
				mil = 3
			}
			define_advisor = {
				type = theologian
				skill = 3
				name = "Signor Caraccioli"
				cost_multiplier = 0.25
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
		create_march = LIB
	}

	after = { # Trigger an event, which will swap the national ideas of pirate tag with correct ideas
		hidden_effect = {
			LIB = {
				country_event = {
					id = pirates.25
				}
			}
		}
	}
}
# Sale
country_event = {
	id = pirates.4
	title = "pirates.4.t"
	picture = BARBARY_PIRATES_eventPicture
	desc = "pirates.4.d"

	fire_only_once = yes

	trigger = {
		NOT = { has_global_flag = pirates_4 }
		has_dlc = "Golden Century"
		not = { exists = SLE }
		NOT = { has_reform = pirate_republic_reform }
		218 = {
			owner = {
				culture_group = iberian
				religion_group = christian
			}
		}
		223 = {
			owner = {
				culture_group = iberian
				religion_group = christian
			}
		}
		owns_core_province = 4563
		num_of_cities = 2
		is_subject = no
		religion_group = muslim
		4563 = {
			privateer_power = { share = 5 }
		}
	}

	immediate = {
		set_global_flag = pirates_4
		hidden_effect = {
			4563 = {
				discover_country = SLE
				add_core = SLE
			}
			218 = {
				owner = {
					save_event_target_as = spain_country
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 12
		# modifiers
	}

	option = { # play as the pirates
		name = "pirates.4.a"
		trigger = {
			ai = no
		}
		# play as SLE
		4563 = {
			add_base_tax = 2
			add_base_manpower = 2
		}
		release = SLE
		create_guarantee = SLE
		SLE = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = ROOT
			discover_provinces = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "Murat" # Jan Janszoon
				dynasty = "Reis"
				adm = 3
				dip = 3
				mil = 4
			}
			if = {
				limit = {
					NOT = { has_idea_group = barbary_pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
		switch_tag = SLE
	}
	option = { # pirates get released as a march
		name = "pirates.4.b"
		4563 = {
			add_base_tax = 2
			add_base_manpower = 2
		}
		release = SLE
		create_march = SLE
		SLE = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "Murat" # Jan Janszoon
				dynasty = "Reis"
				adm = 3
				dip = 3
				mil = 4
			}
			if = {
				limit = {
					NOT = { has_idea_group = barbary_pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
	}
}
# Tetouan
country_event = {
	id = pirates.5
	title = "pirates.5.t"
	picture = BARBARY_PIRATES_eventPicture
	desc = "women_history_events.56.d"

	fire_only_once = yes

	trigger = {
		NOT = { has_global_flag = pirates_5 }
		has_dlc = "Golden Century"
		is_year = 1515
		NOT = { is_year = 1542 }
		NOT = { has_reform = pirate_republic_reform }
		NOT = { exists = TET }
		NOT = { exists = GRA }
		NOT = { exists = ADU }
		owns_core_province = 4561
		num_of_cities = 2
		is_subject = no
		religion_group = muslim
		4561 = {
			privateer_power = { share = 5 }
		}
		223 = {
			owner = {
				culture_group = iberian
				religion_group = christian
			}
		}
	}

	immediate = {
		set_global_flag = pirates_5
		hidden_effect = {
			4561 = {
				discover_country = TET
				add_core = TET
			}
		}
	}

	mean_time_to_happen = {
		months = 12
		# modifiers
	}

	option = { # play as the pirates
		name = "pirates.5.a"
		trigger = {
			ai = no
		}
		4561 = {
			add_base_tax = 2
			add_base_manpower = 2
		}
		release = TET
		create_guarantee = TET
		TET = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = andalucian
			discover_provinces = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "Sayyida"
				dynasty = "al Hurra"
				culture = andalucian
				adm = 4
				dip = 4
				mil = 5
				female = yes
			}
			if = {
				limit = {
					NOT = { has_idea_group = barbary_pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
		switch_tag = TET
	}
	option = { # pirates get released as a march
		name = "pirates.5.b"
		4561 = {
			add_base_tax = 2
			add_base_manpower = 2
		}
		release = TET
		create_march = TET
		TET = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = andalucian
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes
			}
			define_ruler = {
				name = "Sayyida"
				dynasty = "al Hurra"
				culture = andalucian
				adm = 4
				dip = 4
				mil = 5
				female = yes
			}
			if = {
				limit = {
					NOT = { has_idea_group = barbary_pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
	}
}
# Port Royal
country_event = {
	id = pirates.6
	title = "pirates.6.t"
	picture = PIRATE_CAPTAINS_eventPicture
	desc = "pirates.6.d"

	fire_only_once = yes

	trigger = {
		NOT = { has_global_flag = pirates_6 }
		has_dlc = "Golden Century"
		NOT = { exists = PRY }
		has_global_flag = golden_age_of_piracy
		NOT = { has_reform = pirate_republic_reform }
		OR = {
			AND = {
				owns_core_province = 487
				is_subject = no
				num_of_cities = 2
			}
			any_subject_country = {
				owns_core_province = 487
				num_of_cities = 2
			}
		}
		487 = { # must be privateering in node
			privateer_power = {
				country = ROOT
				share = 5
			}
		}
		OR = {
			487 = {
				recent_treasure_ship_passage = yes
			}
			487 = {
				trade_share = {
					country = ROOT
					share = 10
				}
			}
			any_country = {
				capital_scope = {
					region = carribeans_region
				}
				war_exhaustion = 5
			}
		}
	}

	immediate = {
		set_global_flag = pirates_6
		hidden_effect = {
			487 = {
				discover_country = PRY
				add_core = PRY
			}
			random_country = {
				limit = {
					is_rival = ROOT
					any_subject_country = {
						any_owned_province = {
							OR = {
								region = mexico_region
								region = colombia_region
							}
						}
					}
				}
				save_event_target_as = spanish_main_country
			}
		}
	}

	mean_time_to_happen = {
		months = 12
		# modifiers
	}

	option = { # play as the pirates
		name = "pirates.6.a"
		trigger = {
			ai = no
		}
		487 = {
			owner = {
				release = PRY
			}
		}
		PRY = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			change_religion = ROOT
			change_primary_culture = ROOT
			discover_provinces = ROOT
			add_republican_tradition = 50
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "John Davis"
				adm = 2
				dip = 2
				mil = 5
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
		switch_tag = PRY
	}
	option = { # pirates get released
		name = "pirates.6.b"
		487 = {
			owner = {
				release = PRY
			}
		}
		PRY = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			adopt_reform_progress = ROOT
			change_religion = ROOT
			change_primary_culture = ROOT
			add_republican_tradition = 50
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes
			}
			define_ruler = {
				name = "John Davis"
				adm = 2
				dip = 2
				mil = 5
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
	}

	after = { # Trigger an event, which will swap the national ideas of pirate tag with correct ideas
		hidden_effect = {
			PRY = {
				country_event = {
					id = pirates.25
				}
			}
		}
	}
}
# Tortuga - Brethren of the Coast
country_event = {
	id = pirates.7
	title = "pirates.7.t"
	picture = PIRATE_CAPTAINS_eventPicture
	desc = "pirates.7.d"

	fire_only_once = yes

	trigger = {
		NOT = { has_global_flag = pirates_7 }
		has_dlc = "Golden Century"
		NOT = { exists = TOR }
		NOT = { has_reform = pirate_republic_reform }
		489 = {
			OR = {
				religion = protestant
				religion = anglican
				religion = reformed
				religion = hussite
			}
		}
		has_global_flag = golden_age_of_piracy
		OR = {
			AND = {
				owns_core_province = 489
				is_subject = no
				num_of_cities = 2
			}
			any_subject_country = {
				owns_core_province = 489
				num_of_cities = 2
			}
		}
		OR = {
			489 = {
				recent_treasure_ship_passage = yes
			}
			489 = {
				privateer_power = { share = 1 }
			}
			any_country = {
				capital_scope = {
					region = carribeans_region
				}
				war_exhaustion = 5
			}
		}
	}

	immediate = {
		set_global_flag = pirates_7
		hidden_effect = {
			489 = {
				discover_country = TOR
				add_core = TOR
			}
		}
	}

	mean_time_to_happen = {
		months = 12
	}

	option = { # play as the pirates
		name = "pirates.7.a"
		# play as TOR
		trigger = {
			ai = no
		}
		489 = {
			owner = {
				release = TOR
			}
		}
		TOR = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			change_religion = ROOT
			change_primary_culture = ROOT
			discover_provinces = ROOT
			adopt_reform_progress = ROOT
			add_republican_tradition = 50
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "Henry Morgan"
				adm = 3
				dip = 5
				mil = 4
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
		switch_tag = TOR
	}
	option = { # pirates get released
		name = "pirates.7.b"
		489 = {
			owner = {
				release = TOR
			}
		}
		TOR = {
			change_government = republic
			add_government_reform = pirate_republic_reform
			add_republican_tradition = 50
			change_religion = ROOT
			change_primary_culture = ROOT
			adopt_reform_progress = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					artillery = 0.2
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.3
				}
				remove_regular_units_from_prov = yes #changes
			}
			define_ruler = {
				name = "Henry Morgan"
				adm = 3
				dip = 5
				mil = 4
			}
			if = {
				limit = {
					NOT = { has_idea_group = pirate_ideas }
				}
				swap_free_idea_group = yes
			}
			swap_non_generic_missions = yes
			set_ruler_flag = historical_pirate
		}
	}

	after = { # Trigger an event, which will swap the national ideas of pirate tag with correct ideas
		hidden_effect = {
			TOR = {
				country_event = {
					id = pirates.25
				}
			}
		}
	}
}
# Prussian Confederation rises up
country_event = {
	id = flavor_teu.1
	title = "flavor_teu.EVTNAME1"
	desc = "flavor_teu.EVTDESC1"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		NOT = { has_global_flag = flavor_teu_1 }
		is_year = 1460
		NOT = { is_year = 1500 }
		tag = TEU
		NOT = { has_country_flag = pru_confederation_curtailed }
		NOT = { has_estate_privilege = estate_burghers_prussian_confederation }
		has_country_flag = pru_confederation_flag
		is_subject = no
		exists = POL
		is_neighbor_of = POL
		is_at_war = no
		NOT = { alliance_with = POL }
		POL = { is_subject = no }
		POL = { num_of_cities = 10 }
		num_of_cities = 5
		OR = {
			NOT = { exists = DNZ }
			DNZ = {
				is_subject_of = ROOT
			}
		}
		OR = {
			AND = {
				owns = 43
				controls = 43
			}
			DNZ = { owns = 43 controls = 43 }
		}
	}
	
	mean_time_to_happen = {
		months = 6
		modifier = {
			factor = 0.1
			is_year = 1466
		}
	}
	
	immediate = {
		set_global_flag = flavor_teu_1
		hidden_effect = {
			set_country_flag = pru_confederation_happened
			# add cores to DNZ based on burgher land share
			if = {
				limit = {
					estate_influence = {
						estate = estate_burghers
						influence = 40
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
						NOT = { is_core = DNZ }
						OR = {
							area = east_prussia_area
							area = west_prussia_area
						}
						any_neighbor_province = {
							is_core = DNZ
						}
					}
					add_core = DNZ
				}
			}
			if = {
				limit = {
					estate_influence = {
						estate = estate_burghers
						influence = 50
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
						NOT = { is_core = DNZ }
						OR = {
							area = east_prussia_area
							area = west_prussia_area
						}
						any_neighbor_province = {
							is_core = DNZ
						}
					}
					add_core = DNZ
				}
			}
			if = {
				limit = {
					estate_influence = {
						estate = estate_burghers
						influence = 60
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
						NOT = { is_core = DNZ }
						OR = {
							area = east_prussia_area
							area = west_prussia_area
						}
						any_neighbor_province = {
							is_core = DNZ
						}
					}
					add_core = DNZ
				}
			}
			if = {
				limit = {
					estate_influence = {
						estate = estate_burghers
						influence = 70
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
						NOT = { is_core = DNZ }
						OR = {
							area = east_prussia_area
							area = west_prussia_area
						}
						any_neighbor_province = {
							is_core = DNZ
						}
					}
					add_core = DNZ
				}
			}
			if = {
				limit = {
					estate_influence = {
						estate = estate_burghers
						influence = 80
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
						NOT = { is_core = DNZ }
						OR = {
							area = east_prussia_area
							area = west_prussia_area
						}
						any_neighbor_province = {
							is_core = DNZ
						}
					}
					add_core = DNZ
				}
			}
			if = {
				limit = {
					NOT = {
						exists = DNZ
					}
				}
				release = DNZ
				DNZ = {
					change_government = republic
					add_government_reform = oligarchy_reform
					adopt_reform_progress = ROOT
				}
			}
			else = {
				every_owned_province = {
					limit = {
						is_core = DNZ
					}
					cede_province = DNZ
				}
			}
			DNZ = {
				capital_scope = {
					build_to_forcelimit = {
						infantry = 0.6
						cavalry = 0.3
					}
					remove_regular_units_from_prov = yes #changes
				}
				random_owned_province = {
					limit = {
						has_port = yes
					}
					build_to_forcelimit = {
						galley = 0.3
						light_ship = 0.3
						transport = 0.2
					}
				}
			}
		}
	}
	
	option = { # Go to war
		name = "flavor_teu.1.a"
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = yes
					war_exhaustion = 10
				}
			}
			 
		}
		declare_war_with_cb = {
			who = DNZ
			casus_belli = cb_core
			war_goal_province = 43
		}
		custom_tooltip = flavor_teu.1.tooltip
		hidden_effect = {
			POL = {
				country_event = { id = flavor_teu.2 }
			}
			POL = {
				create_guarantee = DNZ
			}
		}
	}
	option = { # Let them go
		name = "flavor_teu.1.b"
		ai_chance = { 
			factor = 100 
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = no
					NOT = { war_exhaustion = 10 }
				}
			}
		}
		add_stability = -1
		add_prestige = -20
	}
}
#The Nguni Militarization
country_event = {
	id = flavor_zim.3
	title = flavor_zim.3.t
	desc = flavor_zim.3.d
	picture = AFRICAN_DISCIPLINE_eventPicture
	is_triggered_only = yes

	option = {	#Neat
		name = flavor_zim.3.a
		add_mil_power = 100
		add_country_modifier = {
			name = zim_nguni_militarization
			duration = 9125
		}
		custom_tooltip = flavor_zim.3.a.tt
		hidden_effect = {
			set_country_flag = can_attract_zulu
		}

		ai_chance = {
			factor = 1
		}
	}

	option = {	#Make them to our march!
		name = flavor_zim.3.b
		789 = { add_core = ZUL cede_province = ZUL }
		1181 = { add_core = ZUL cede_province = ZUL }
		hidden_effect = {
			ZUL = {
				if = {
					limit = {
						is_year = 1810
					}
					define_ruler = {
						name = "Shaka"
						dynasty = "Zulu"
						adm = 5
						dip = 3
						mil = 6
						age = 23
						claim = 100
					}
					define_ruler_to_general = {
						fire = 4
						shock = 5
						manuever = 4
						siege = 2
					}
				}
				else = {
					define_ruler = {
						adm = 3
						dip = 3
						mil = 5
						age = 20
						claim = 100
					}
				}
				if = {
					limit = {
						has_dlc = "Rights of Man" 
					}
					hidden_effect = { add_ruler_personality_ancestor = { key = strict } }
				}
				change_government = tribal
				add_government_reform = shaka_regime
				set_capital = 789
				capital_scope = {
					change_province_name = "Bulawayo"
					rename_capital = "Bulawayo"
					add_base_tax = 3
					add_base_production = 3
					add_base_manpower = 2
					build_to_forcelimit = {
						infantry = 0.9
						cavalry = 0.1
					}
					remove_regular_units_from_prov = yes #changes
				}
				add_manpower = 15
				add_treasury = 300
				add_army_professionalism = 0.05
				add_army_tradition = 20
			}
		}
		create_march = ZUL

		ai_chance = {
			factor = 0
		}
	}

	option = {	#Play as the Zulu
		name = flavor_zim.3.c
		789 = { add_core = ZUL cede_province = ZUL }
		1181 = { add_core = ZUL cede_province = ZUL }
		hidden_effect = {
			ZUL = {
				if = {
					limit = {
						is_year = 1810
					}
					define_ruler = {
						name = "Shaka"
						dynasty = "Zulu"
						adm = 5
						dip = 3
						mil = 6
						age = 23
						claim = 100
					}
					define_ruler_to_general = {
						fire = 4
						shock = 5
						manuever = 4
						siege = 2
					}
				}
				else = {
					define_ruler = {
						adm = 3
						dip = 3
						mil = 5
						age = 20
						claim = 100
					}
				}
				if = {
					limit = {
						has_dlc = "Rights of Man" 
					}
					hidden_effect = { add_ruler_personality_ancestor = { key = strict } }
				}
				change_government = tribal
				add_government_reform = shaka_regime
				set_capital = 789
				capital_scope = {
					change_province_name = "Bulawayo"
					rename_capital = "Bulawayo"
					add_base_tax = 3
					add_base_production = 3
					add_base_manpower = 2
					build_to_forcelimit = {
						infantry = 0.9
						cavalry = 0.1
					}
					remove_regular_units_from_prov = yes #changes
				}
				add_manpower = 15
				add_treasury = 300
				add_army_professionalism = 0.05
				add_army_tradition = 20
			}
		}
		switch_tag = ZUL

		ai_chance = {
			factor = 0
		}
	}
}
# The appearance of the Zulu
country_event = {
	id = flavor_zul.1
	title = flavor_zul.1.t
	desc = {
		trigger = {
			has_country_flag = zulu_attracted_flag
		}
		desc = flavor_zul.1.d.a
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = zulu_attracted_flag }
		}
		desc = flavor_zul.1.d.a
	}
	picture = AFRICAN_CHIEFTAIN_eventPicture
	fire_only_once = yes

	trigger = {
		NOT = { has_global_flag = flavor_zul_1 }
		num_of_cities = 3
		789 = {
			owned_by = ROOT
			NOT = { is_capital_of = ROOT }	#The country should not get instantly killed when they are an OPM
			culture = nguni
		}
		OR = {
			is_year = 1750
			has_country_flag = zulu_attracted_flag	#Mission / Decision "reward" to get the Zulu much faster at the expense of historical inaccuracy
		}
		NOT = { exists = ZUL }
		NOT = { tag = ZIM }	#Has Decision / Mission instead to trigger the Zulu
		NOT = { tag = GZI }
	}

	mean_time_to_happen = {
		months = 240
		modifier = {
			factor = 0.5
			is_year = 1800
		}
		modifier = {
			factor = 0.01
			is_year = 1816	#Actual date of their appearance
		}
		modifier = {
			factor = 0.01
			has_country_flag = zulu_attracted_flag	#Mission "reward" to get the Zulu much faster
		}
	}

	immediate = {
		set_global_flag = flavor_zul_1
		hidden_effect = {
			789 = { add_core = ZUL cede_province = ZUL }
			if = {
				limit = { 1181 = { owned_by = ROOT NOT = { is_capital_of = ROOT } } }
				1181 = { add_core = ZUL cede_province = ZUL }
			}
			else = {
				1181 = { add_core = ZUL }
			}
			ZUL = {
				if = {
					limit = {
						is_year = 1800
					}
					define_ruler = {
						name = "Shaka"
						dynasty = "Zulu"
						adm = 5
						dip = 3
						mil = 6
						age = 23
						claim = 100
					}
					define_ruler_to_general = {
						fire = 4
						shock = 5
						manuever = 4
						siege = 2
					}
				}
				else = {
					define_ruler = {
						adm = 3
						dip = 3
						mil = 5
						age = 20
						claim = 100
					}
				}
				if = {
					limit = {
						has_dlc = "Rights of Man" 
					}
					hidden_effect = { add_ruler_personality_ancestor = { key = strict } }
				}
				change_government = tribal
				add_government_reform = shaka_regime
				set_capital = 789
				capital_scope = {
					change_province_name = "Bulawayo"
					rename_capital = "Bulawayo"
					add_base_tax = 3
					add_base_production = 3
					add_base_manpower = 2
					build_to_forcelimit = {
						infantry = 0.9
						cavalry = 0.1
					}
					remove_regular_units_from_prov = yes #changes
				}
				add_manpower = 15
				add_treasury = 300
				add_army_professionalism = 0.05
				add_army_tradition = 20
			}
			limpopo_area = {
				limit = {
					NOT = { is_core = ZUL }
					NOT = { is_permanent_claim = ZUL }
				}
				add_permanent_claim = ZUL
			}
		}
	}
	
	option = {	#How dare taking our land!
		name = flavor_zul.1.a
		tooltip = {
			789 = { add_core = ZUL cede_province = ZUL }
			1181 = { add_core = ZUL cede_province = ZUL }
		}
		declare_war_with_cb = {
			casus_belli = cb_imperial
			who = ZUL
		}
		ai_chance = {
			factor = 1
			modifier = {	#Is currently busy with another war
				factor = 0
				is_at_war = yes
			}
			modifier = {	#Doesn't really care
				factor = 0
				num_of_owned_provinces_with = {
					region = south_africa_region
					value = 3
				}
			}
		}
	}
	
	option = {	#Ehh ... whatever
		name = flavor_zul.1.b
		tooltip = {
			789 = { add_core = ZUL cede_province = ZUL }
			1181 = { add_core = ZUL cede_province = ZUL }
		}
		reverse_add_opinion = {
			who = ZUL
			modifier = zul_let_the_zulu_alone
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				is_at_war = no
			}
			modifier = {
				factor = 0
				NOT = {
					num_of_owned_provinces_with = {
						region = south_africa_region
						value = 3
					}
				}
			}
		}
	}
	
	option = {	#Screw my throne, I am a Zulu now!
		name = flavor_zul.1.c
		trigger = { ai = no }
		tooltip = {
			789 = { add_core = ZUL cede_province = ZUL }
			1181 = { add_core = ZUL cede_province = ZUL }
		}
		switch_tag = ZUL
	}
}
# Koxinga Flees to Taiwan
country_event = {
	id = mch_missions.5
	title = "mch_missions.5.t"
	desc = "mch_missions.5.d"
	picture = NAVAL_MILITARY_eventPicture
	
	fire_only_once = yes
	major = yes
	
	trigger = {
		NOT = { has_global_flag = mch_missions_5 }
		tag = MNG
		NOT = {
			total_development = 600
		}
		any_province = {
			area = taiwan_area
			is_empty = yes
		}
	}
	mean_time_to_happen = {
		months = 120
	}
	immediate = {
		set_global_flag = mch_missions_5
		hidden_effect = {
			taiwan_area = {
				limit = {
					is_empty = yes
				}
				add_core = FRM
				cede_province = FRM
				change_culture = chimin
			}
		}
	}
	option = {
		name = "mch_missions.5.a"
		if = {
			limit = {
				is_emperor_of_china = yes
			}
			add_mandate = -10
		}
		else = {
			add_prestige = -10
		}
		FRM = {
			define_ruler = {
				name = "Koxinga"
				dynasty = "Zheng"
			}
			add_accepted_culture = polynesian
			add_harmonized_religion = animism
			change_government = monarchy
			add_government_reform = chinese_warlord
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.6
					cavalry = 0.3
					artillery = 0.1
				}
				remove_regular_units_from_prov = yes #changes
			}
			random_owned_province = {
				limit = {
					has_port = yes
				}
				build_to_forcelimit = {
					heavy_ship = 0.3
					light_ship = 0.3
					transport = 0.2
				}
			}
		}
	}
}